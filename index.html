<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Chat Ao Vivo</title>
<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background: black;
        color: white;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .container {
        width: 100%;
        max-width: 600px;
        height: 100%;
        display: flex;
        flex-direction: column;
    }

    /* Tela de login */
    .login {
        flex: 1;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
    }

    .login input {
        padding: 10px;
        font-size: 16px;
        border: none;
        outline: none;
        margin-bottom: 10px;
        width: 200px;
        text-align: center;
    }

    .login button {
        padding: 10px 20px;
        background: white;
        color: black;
        border: none;
        cursor: pointer;
        font-weight: bold;
    }

    /* Chat */
    .chat {
        display: none;
        flex: 1;
        flex-direction: column;
    }

    .messages {
        flex: 1;
        padding: 10px;
        overflow-y: auto;
        font-size: 14px;
    }

    .message {
        margin-bottom: 6px;
    }

    .user {
        color: #38bdf8;
        font-weight: bold;
    }

    .input-area {
        display: flex;
        border-top: 1px solid #333;
    }

    .input-area input {
        flex: 1;
        padding: 10px;
        border: none;
        outline: none;
        background: black;
        color: white;
        font-size: 14px;
    }

    .input-area button {
        padding: 10px 15px;
        background: white;
        color: black;
        border: none;
        cursor: pointer;
        font-weight: bold;
    }
</style>
</head>
<body>

<div class="container">

    <!-- Tela de Nome -->
    <div class="login" id="loginScreen">
        <h2>Escolha seu nome</h2>
        <input type="text" id="usernameInput" placeholder="Seu nome">
        <button onclick="saveName()">Entrar no chat</button>
    </div>

    <!-- Chat -->
    <div class="chat" id="chatScreen">
        <div class="messages" id="messages"></div>
        <div class="input-area">
            <input type="text" id="messageInput" placeholder="Digite sua mensagem...">
            <button onclick="sendMessage()">Enviar</button>
        </div>
    </div>

</div>

<script>
const loginScreen = document.getElementById("loginScreen");
const chatScreen = document.getElementById("chatScreen");
const messagesDiv = document.getElementById("messages");

// Verifica se jÃ¡ existe nome salvo
const savedName = localStorage.getItem("chat-username");
if (savedName) {
    showChat();
}

// Salvar nome
function saveName() {
    const name = document.getElementById("usernameInput").value.trim();
    if (name === "") return;
    localStorage.setItem("chat-username", name);
    showChat();
}

// Mostrar chat
function showChat() {
    loginScreen.style.display = "none";
    chatScreen.style.display = "flex";
}

// Enviar mensagem
function sendMessage() {
    const username = localStorage.getItem("chat-username");
    const message = document.getElementById("messageInput").value;

    if (!message.trim()) return;

    const data = {
        user: username,
        text: message,
        time: Date.now()
    };

    // Envia para outras abas
    localStorage.setItem("chat-message", JSON.stringify(data));

    showMessage(username, message);
    document.getElementById("messageInput").value = "";
}

// Receber mensagens em tempo real
window.addEventListener("storage", (event) => {
    if (event.key === "chat-message") {
        const data = JSON.parse(event.newValue);
        showMessage(data.user, data.text);
    }
});

// Mostrar mensagem
function showMessage(user, text) {
    const msg = document.createElement("div");
    msg.className = "message";
    msg.innerHTML = `<span class="user">${user}:</span> ${text}`;
    messagesDiv.appendChild(msg);
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
}
</script>

</body>
</html>